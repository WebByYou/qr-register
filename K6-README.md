# การทดสอบโหลดด้วย k6

## ข้อกำหนดเบื้องต้น

ติดตั้ง k6:

```bash
brew install k6
```

## การรันการทดสอบ

### การทดสอบพื้นฐาน (100 ผู้ใช้พร้อมกันเป็นเวลา 4 นาที)

```bash
k6 run k6-load-test.js
```

### การทดสอบแบบเร็ว (10 ผู้ใช้)

```bash
k6 run --vus 10 --duration 30s k6-load-test.js
```

### การทดสอบความเครียด (1000 การลงทะเบียน)

เพื่อสร้าง 1000 การลงทะเบียน ให้รัน:

```bash
k6 run --vus 100 --duration 10s k6-load-test.js
```

หรือแบบค่อยเป็นค่อยไป:

```bash
k6 run --vus 50 --duration 20s k6-load-test.js
```

## สิ่งที่การทดสอบทำ

- สร้างชื่อภาษาไทยแบบสุ่มและรหัสพนักงาน 6 หลัก
- ส่งคำขอ POST ไปยัง `/api/registrations/create`
- ติดตามการลงทะเบียนที่สำเร็จและล้มเหลว
- วัดเวลาตอบสนองและอัตราข้อผิดพลาด

## ตัวชี้วัดที่ควรดู

- **http_req_duration**: เวลาตอบสนอง (ควรน้อยกว่า 2 วินาทีสำหรับ 95% ของคำขอ)
- **http_req_failed**: อัตราข้อผิดพลาด (ควรน้อยกว่า 10%)
- **successful_registrations**: จำนวนการลงทะเบียนที่สำเร็จ
- **failedRegistrations**: จำนวนการลงทะเบียนที่ล้มเหลว

## ผลลัพธ์ที่คาดหวัง

การทดสอบจะแสดง:

- อัตราคำขอ (คำขอ/วินาที)
- เวลาตอบสนองเฉลี่ย
- เวลาตอบสนอง P95
- อัตราข้อผิดพลาด
- จำนวนการลงทะเบียนที่สำเร็จ/ล้มเหลวทั้งหมด

## หมายเหตุ

- ตรวจสอบให้แน่ใจว่าเซิร์ฟเวอร์ dev ของคุณกำลังทำงานที่พอร์ต 3000
- การทดสอบใช้ความล่าช้า 1 วินาทีระหว่างคำขอต่อผู้ใช้เสมือน
- ปรับ `--vus` และ `--duration` เพื่อควบคุมความเข้มของโหลด
